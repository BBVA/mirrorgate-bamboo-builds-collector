version: '2'

services:
  install:
      image: "node:7-slim"
      volumes:
        - .:/tmp/repo
        - ~/.npmrc:/tmp/repo/.npmrc
      working_dir: "/tmp/repo"
      command: "npm install && cd collector && npm install"
  package:
      image: "node:7-slim"
      volumes:
        - .:/tmp/repo
        - ~/.npmrc:/tmp/repo/.npmrc
      working_dir: "/tmp/repo"
      command: "./node_modules/gulp/bin/gulp.js package"